
<!-- Question -->
<div class="card shadow-sm mb-3" *ngIf="q">
  <div class="card-body">
    <h2 class="h5 mb-2">{{ q.title }}</h2>
    <p class="mb-3">{{ q.text }}</p>

    <div class="imgs mb-2" *ngIf="questionImages?.length">
      <img *ngFor="let img of questionImages"
           [src]="asUrl(img)"
           alt="question image"
           class="rounded border"
           style="max-width:200px; max-height:150px; object-fit:cover; margin:0 .5rem .5rem 0;" />
    </div>

    <small class="text-muted">
      By {{ q.author || 'Anon' }} • {{ q.createdAt | date }}
    </small>
  </div>
</div>

<!-- Answers -->
<div class="card shadow-sm mb-3" *ngIf="answers?.length">
  <div class="card-body">
    <h3 class="h6 mb-3">Answers</h3>

    <div *ngFor="let a of answers" class="answer mb-3 pb-3 border-bottom">
      <p class="mb-2">{{ a.text }}</p>

      <div class="imgs mb-2" *ngIf="a.images?.length">
        <img *ngFor="let im of a.images"
             [src]="asUrl(im)"
             alt="answer image"
             class="rounded border"
             style="max-width:200px; max-height:150px; object-fit:cover; margin:0 .5rem .5rem 0;" />
      </div>

      <small class="text-muted">
        By {{ a.author || 'Anon' }} • {{ a.createdAt ? (a.createdAt | date:'short') : '' }}
        <span *ngIf="a.status && a.status !== 'Approved'"> • ({{ a.status }})</span>
      </small>
    </div>
  </div>
</div>

<!-- Answer form -->
<div class="card shadow-sm mb-3">
  <div class="card-body">
    <form [formGroup]="f" (ngSubmit)="post()">

      <!-- Textarea -->
      <div class="mb-3">
        <label for="answerBody" class="form-label fw-semibold">Your Answer</label>
        <textarea id="answerBody"
                  class="form-control"
                  rows="4"
                  formControlName="body"
                  placeholder="Write your answer here..."></textarea>
      </div>

      <!-- Cloud upload button -->
      <div class="mb-3">
        <label class="btn btn-outline-primary">
          <i class="bi bi-cloud-upload"></i> Choose Images
          <input type="file" (change)="onFiles($event)" multiple hidden />
        </label>
      </div>

      <!-- Submit -->
      <button type="submit" class="btn btn-primary" [disabled]="f.invalid">
        Post Answer
      </button>
    </form>
  </div>
</div>
